# Readme

## 1.环境

1. pytorch1.13.0+cpu
2. torchvision 0.14.0+cpu
3. PIL

## 2.数据集

### 2.1 数据集的下载

本次模型的数据集来自kaggle。[下载](https://www.kaggle.com/competitions/bitmoji-faces-gender-recognition/data)

### 2.2数据集的配置

模型训练的数据集配置：在模型的根目录下的data文件夹内，把下载的数据直接放进去就好了

代码`make_data_txt.py`里面的`make_train_test`函数可以划分并制作训练集合测试集，并生成对应的TXT文件。TXT文件存储的内容是照片的路径和标签。其中的`make_detection`可以制作检测集的TXT文件。

##3.训练

在制作好训练集和测试集之后，运行`main.py`就可以进行训练，总共训练10个epochs，这里使用CPU进行训练大约进行了40分钟，训练的结果会保存在根目录下。

## 4.网络结构



| 层数       | 输入通道 | 输出通道 | 卷积核 | 步长 |  输入大小  | 输出大小 |
| ---------- | :------: | -------- | ------ | :--: | :--------: | :------: |
| 第一层卷积 |    3     | 6        | 5      |  1   |  224*224   | 220*220  |
| 池化       |    6     | 6        | 2      |  2   |  220*220   | 110*110  |
| 第二层卷积 |    6     | 16       | 5      |  1   |  110*110   | 106*106  |
| 池化       |    16    | 16       | 2      |  2   |  106*106   |  53 *53  |
| 全连接1    |    --    | --       | --     |  --  | 16* 53 *53 |   1024   |
| 全连接2    |    --    | --       | --     |  --  |    1024    |   512    |
| 全连接3    |    --    | --       | --     |  --  |    512     |    2     |

## 5.训练结果

该模型最终的准确度为99.472%

## 6.预测结果

运行`detedt.py`就可以得到预测结果，将会保存在根目录下的CSV文件中







